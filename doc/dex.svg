<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="262px" preserveAspectRatio="none" style="width:635px;height:262px;" version="1.1" viewBox="0 0 635 262" width="635px" zoomAndPan="magnify"><defs><filter height="300%" id="fb9oqdm9yo0cf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster FC--><polygon fill="#FFFFFF" filter="url(#fb9oqdm9yo0cf)" points="14,26,24,16,577,16,577,92,567,102,14,102,14,26" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="567" x2="576" y1="26" y2="17"/><line style="stroke: #000000; stroke-width: 1.5;" x1="14" x2="567" y1="26" y2="26"/><line style="stroke: #000000; stroke-width: 1.5;" x1="567" x2="567" y1="26" y2="102"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="239.5" y="42.5352">Flow Collector</text><!--cluster DEX_HOST--><polygon fill="#FFFFFF" filter="url(#fb9oqdm9yo0cf)" points="184,174,194,164,613,164,613,240,603,250,184,250,184,174" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="603" x2="612" y1="174" y2="165"/><line style="stroke: #000000; stroke-width: 1.5;" x1="184" x2="603" y1="174" y2="174"/><line style="stroke: #000000; stroke-width: 1.5;" x1="603" x2="603" y1="174" y2="250"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="326" y="190.5352">Data Exporter Host</text><!--entity Engine--><polygon fill="#FEFECE" filter="url(#fb9oqdm9yo0cf)" points="22.5,58,32.5,48,109.5,48,109.5,84.4883,99.5,94.4883,22.5,94.4883,22.5,58" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="99.5" x2="108.5" y1="58" y2="49"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22.5" x2="99.5" y1="58" y2="58"/><line style="stroke: #000000; stroke-width: 1.5;" x1="99.5" x2="99.5" y1="58" y2="94.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="37.5" y="81.5352">Engine</text><!--entity FF--><polygon fill="#FEFECE" filter="url(#fb9oqdm9yo0cf)" points="208.5,58,218.5,48,355.5,48,355.5,84.4883,345.5,94.4883,208.5,94.4883,208.5,58" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="345.5" x2="354.5" y1="58" y2="49"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="345.5" y1="58" y2="58"/><line style="stroke: #000000; stroke-width: 1.5;" x1="345.5" x2="345.5" y1="58" y2="94.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="223.5" y="81.5352">Flow Forwarder</text><!--entity FC_TRUST--><rect fill="#FEFECE" filter="url(#fb9oqdm9yo0cf)" height="32.4883" style="stroke: #000000; stroke-width: 1.5;" width="87" x="481.5" y="57"/><rect fill="#FEFECE" height="32.4883" style="stroke: #000000; stroke-width: 1.5;" width="87" x="477.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="485.5" y="74.5352">Truststore</text><!--entity DEX--><polygon fill="#FEFECE" filter="url(#fb9oqdm9yo0cf)" points="192.5,206,202.5,196,371.5,196,371.5,232.4883,361.5,242.4883,192.5,242.4883,192.5,206" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="361.5" x2="370.5" y1="206" y2="197"/><line style="stroke: #000000; stroke-width: 1.5;" x1="192.5" x2="361.5" y1="206" y2="206"/><line style="stroke: #000000; stroke-width: 1.5;" x1="361.5" x2="361.5" y1="206" y2="242.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="207.5" y="229.5352">Data Exporter Client</text><!--entity DEX_TRUST--><rect fill="#FEFECE" filter="url(#fb9oqdm9yo0cf)" height="32.4883" style="stroke: #000000; stroke-width: 1.5;" width="87" x="517.5" y="205"/><rect fill="#FEFECE" height="32.4883" style="stroke: #000000; stroke-width: 1.5;" width="87" x="513.5" y="201"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="521.5" y="222.5352">Truststore</text><!--link Engine to FF--><path d="M109.7108,71 C136.5068,71 171.6045,71 203.125,71 " fill="none" id="Engine-FF" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="208.1513,71,199.1513,67,203.1513,71,199.1513,75,208.1513,71" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="128" y="49.5684">flow stats</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="129" y="64.8789">over ZMQ</text><!--link FF to FC_TRUST--><path d="M355.6175,71 C393.328,71 438.2962,71 472.1225,71 " fill="none" id="FF-FC_TRUST" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="477.4529,71,468.4529,67,472.4529,71,468.4529,75,477.4529,71" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="374" y="49.5684">authenticates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="399" y="64.8789">client</text><!--link FF to DEX--><path d="M282,94.125 C282,120.147 282,162.4367 282,190.4847 " fill="none" id="FF-DEX" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="282,195.549,286,186.549,282,190.549,278,186.549,282,195.549" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="325.5" y="137.5684">flow stats</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="283" y="152.8789">over secure web socket</text><!--link DEX to DEX_TRUST--><path d="M371.5514,219 C416.7822,219 470.0062,219 508.1604,219 " fill="none" id="DEX-DEX_TRUST" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="513.2063,219,504.2063,215,508.2063,219,504.2063,223,513.2063,219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="390" y="212.5684">authenticates FC</text><!--
@startuml

node "Flow Collector" as FC {
    node "Engine" as Engine
    node "Flow Forwarder" as FF
    collections "Truststore" as FC_TRUST
}

node "Data Exporter Host" as DEX_HOST {
   node "Data Exporter Client" as DEX
   collections "Truststore" as DEX_TRUST
}

Engine .> FF: flow stats\nover ZMQ
FF .> FC_TRUST: authenticates\nclient
FF ..> DEX: flow stats\nover secure web socket 
DEX .> DEX_TRUST: authenticates FC

@enduml

PlantUML version 1.2018.12(Sun Oct 21 06:15:15 EDT 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>